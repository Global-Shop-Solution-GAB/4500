-- EINVOICE_FLG added from FILLER
SET TRUENULLCREATE = OFF;
SET TRUEBITCREATE = OFF;

DROP TABLE ORDER_HIST_HEAD IN DICTIONARY;
DROP VIEW V_ORDER_HIST_HEAD;

CREATE TABLE ORDER_HIST_HEAD IN DICTIONARY USING '..\..\FILES\IVHHD@@@'
(INVOICE CHAR(7) NOT NULL,
ORDER_NO CHAR(7) NOT NULL,
ORDER_SUFFIX CHAR(4) NOT NULL,
ORDER_TYPE CHAR(1) NOT NULL,
CUSTOMER CHAR(6) NOT NULL,
FILL_CUST CHAR(1) NOT NULL,
BUY_GROUP_CUST CHAR(6) NOT NULL,
FILL_BUY_GROUP CHAR(1) NOT NULL,
FLAG_BUY_GROUP CHAR(1) NOT NULL,
DATE_ORDER CHAR(8) NOT NULL,
DATE_ORDER_DUE CHAR(8) NOT NULL,
DATE_PO_EXPIRE CHAR(8) NOT NULL,
CUSTOMER_PO CHAR(15) NOT NULL,
FILL_CUSTPO CHAR(15) NOT NULL,
CONTRACT NUMERIC(6,0) NOT NULL,
NAME_CUSTOMER CHAR(30) NOT NULL,
FILL_NAME CHAR(10) NOT NULL,
ADDRESS1 CHAR(30) NOT NULL,
FILL_ADR1 CHAR(10) NOT NULL,
ADDRESS2 CHAR(30) NOT NULL,
FILL_ADR2 CHAR(10) NOT NULL,
ADDRESS3 CHAR(30) NOT NULL,
FILL_ADR3 CHAR(10) NOT NULL,
ADDRESS4 CHAR(30) NOT NULL,
FILL_ADR4 CHAR(10) NOT NULL,
ADDRESS5 CHAR(30) NOT NULL,
FILL_ADR5 CHAR(10) NOT NULL,
CITY CHAR(15) NOT NULL,
FILL_CITY CHAR(10) NOT NULL,
STATE CHAR(3) NOT NULL,
ZIP CHAR(13) NOT NULL,
COUNTRY CHAR(12) NOT NULL,
FILL_COUNTRY CHAR(13) NOT NULL,
FLAG_INTL CHAR(1) NOT NULL,
ATTENTION CHAR(30) NOT NULL,
FILL_ATTN CHAR(10) NOT NULL,
FILLER13 CHAR(13) NOT NULL,
CONTACT CHAR(30) NOT NULL,
CONTACT_PHONE CHAR(20) NOT NULL,
CONTACT_EMAIL CHAR(100) NOT NULL,
CODE_SORT CHAR(20) NOT NULL,
ORDER_SORT_2 CHAR(30) NOT NULL,
USER_1 CHAR(30) NOT NULL,
USER_2 CHAR(30) NOT NULL,
USER_3 CHAR(30) NOT NULL,
USER_4 CHAR(30) NOT NULL,
USER_5 CHAR(30) NOT NULL,
QUOTE CHAR(7) NOT NULL,
TERMS CHAR(10) NOT NULL,
FLAG_TIME_MATL CHAR(1) NOT NULL,
LOCATION CHAR(2) NOT NULL,
FLAG_ALWAYS_DISC CHAR(1) NOT NULL,
FLAG_SPCD CHAR(1) NOT NULL,
PRICE_SCHEDULE CHAR(9) NOT NULL,
COMPANY_CURRENCY CHAR(3) NOT NULL,
CATALOG_CURRENCY CHAR(3) NOT NULL,
ORDER_CURRENCY CHAR(3) NOT NULL,
DATE_EXCHANGE_FO_TC CHAR(8) NOT NULL,
EXCHANGE_RATE_FO_TC NUMERIC(10,5) NOT NULL,
DATE_EXCHANGE_FC_TO CHAR(8) NOT NULL,
EXCHANGE_RATE_FC_TO NUMERIC(10,5) NOT NULL,
DATE_EXCHANGE_FL_TO CHAR(8) NOT NULL,
EXCHANGE_RATE_FL_TO NUMERIC(10,5) NOT NULL,
DATE_EXCHANGE_FL_TC CHAR(8) NOT NULL,
EXCHANGE_RATE_FL_TC NUMERIC(10,5) NOT NULL,
DATE_SHIPPED CHAR(8) NOT NULL,
CUSTOMER_SHIP CHAR(6) NOT NULL,
NAME_CUSTOMER_SHIP CHAR(30) NOT NULL,
FILL_NS CHAR(10) NOT NULL,
ADDRESS1_SHIP CHAR(30) NOT NULL,
FILL_ADR1S CHAR(10) NOT NULL,
ADDRESS2_SHIP CHAR(30) NOT NULL,
FILL_ADR2S CHAR(10) NOT NULL,
ADDRESS3_SHIP CHAR(30) NOT NULL,
FILL_ADR3S CHAR(10) NOT NULL,
ADDRESS4_SHIP CHAR(30) NOT NULL,
FILL_ADR4S CHAR(10) NOT NULL,
ADDRESS5_SHIP CHAR(30) NOT NULL,
FILL_ADR5S CHAR(10) NOT NULL,
CITY_SHIP CHAR(15) NOT NULL,
FILL_CS CHAR(10) NOT NULL,
STATE_SHIP CHAR(3) NOT NULL,
ZIP_SHIP CHAR(13) NOT NULL,
COUNTRY_SHIP CHAR(12) NOT NULL,
FILL_CTRYS CHAR(13) NOT NULL,
FLAG_INTL_SHIP CHAR(1) NOT NULL,
ATTENTION_SHIP CHAR(30) NOT NULL,
FILL_ATTNS CHAR(10) NOT NULL,
FLAG_INS CHAR(1) NOT NULL,
FLAG_CERT_ENCL CHAR(1) NOT NULL,
MARK_INFO CHAR(30) NOT NULL,
FOB_INFO CHAR(14) NOT NULL,
WAYBILL CHAR(19) NOT NULL,
BATCH CHAR(5) NOT NULL,
DATE_INVOICE CHAR(8) NOT NULL,
COMPLEMENT_DATE_INV CHAR(8) NOT NULL,
FLAG_EXCL_BOM_COMP CHAR(1) NOT NULL,
FLAG_1_INV_ORDER CHAR(1) NOT NULL,
FLAG_1_INV_CUST CHAR(1) NOT NULL,
FLAG_1_INV_SORT CHAR(1) NOT NULL,
FLAG_1_INV_ITEM CHAR(1) NOT NULL,
FLAG_1_INV_PART CHAR(1) NOT NULL,
COST_MATERIAL NUMERIC(11,2) NOT NULL,
COST_LABOR NUMERIC(11,2) NOT NULL,
COST_OUTSIDE NUMERIC(11,2) NOT NULL,
COST_OVERHEAD NUMERIC(11,2) NOT NULL,
COST_OTHER NUMERIC(11,2) NOT NULL,
JOB CHAR(6) NOT NULL,
FILL_JOB CHAR(1) NOT NULL,
SUFFIX CHAR(3) NOT NULL,
FILL_SUFFIX CHAR(1) NOT NULL,
PRODUCT_CODE CHAR(3) NOT NULL,
JOB_DESCRIPTION CHAR(30) NOT NULL,
FILL_DESC CHAR(20) NOT NULL,
FLAG_JOB_CLOSE CHAR(1) NOT NULL,
PART_JOB CHAR(20) NOT NULL,
PART_FILL CHAR(18) NOT NULL,
LOCATION_JOB CHAR(2) NOT NULL,
QTY_JOB NUMERIC(13,4) NOT NULL,
FLAG_PRICE_AT_COST CHAR(1) NOT NULL,
CREDIT_MEMO_FLAG CHAR(1) NOT NULL,
INVOICE_ORIGINAL CHAR(6) NOT NULL,
FILL_INV_O CHAR(1) NOT NULL,
DATE_ORIG_INVOICE CHAR(8) NOT NULL,
FLAG_TAX_ADJ CHAR(1) NOT NULL,
ORDER_SOURCE CHAR(1) NOT NULL,
HISTORY_SOURCE CHAR(1) NOT NULL,
HISTORY_VERSION CHAR(2) NOT NULL,
FREIGHT_ZONE CHAR(10) NOT NULL,
FLAG_COMPL_SHIP CHAR(1) NOT NULL,
PAYMENT_TYPE CHAR(2) NOT NULL,
PLST_FLAG CHAR(1) NOT NULL,
CREDIT_MEMO_TYPE CHAR(1) NOT NULL,
DD250_FLAG CHAR(1) NOT NULL,
LUMP_SUM_FLAG CHAR(1) NOT NULL,
FILL_LS_AMT NUMERIC(1,0) NOT NULL,
LUMP_SUM_AMT NUMERIC(15,2) NOT NULL,
LANG_CD CHAR(3) NOT NULL,
CARRIER_CD CHAR(6) NOT NULL,
THRD_PRTY_FRT_CUST CHAR(7) NOT NULL,
PCK_NO CHAR(7) NOT NULL,
TRACKING_NO CHAR(30) NOT NULL,
TRACKING_FLAG CHAR(1) NOT NULL,
ETA_DATE CHAR(8) NOT NULL,
TRANS_METHOD CHAR(10) NOT NULL,
TERMS_DISC_DUE_DATE CHAR(8) NOT NULL,
TERMS_DISC_AMT NUMERIC(10,2) NOT NULL,
TERMS_DISC_AMT_ORDER NUMERIC(10,2) NOT NULL,
PROJECT CHAR(7) NOT NULL,
CARRIER_ACCT CHAR(25) NOT NULL,
IVC_UPD_SCRIPT_FLG CHAR(1) NOT NULL,
CARTONS NUMERIC(8,0) NOT NULL,
WEIGHT NUMERIC(12,4) NOT NULL,
TAX_APPLY_1 CHAR(1) NOT NULL,
TAX_APPLY_2 CHAR(1) NOT NULL,
TAX_APPLY_3 CHAR(1) NOT NULL,
TAX_APPLY_4 CHAR(1) NOT NULL,
TAX_APPLY_5 CHAR(1) NOT NULL,
TAX_APPLY_6 CHAR(1) NOT NULL,
TAX_APPLY_7 CHAR(1) NOT NULL,
TAX_APPLY_8 CHAR(1) NOT NULL,
TAX_APPLY_9 CHAR(1) NOT NULL,
TAX_APPLY_10 CHAR(1) NOT NULL,
PRO_NO CHAR(20) NOT NULL,
PRGBILL_ONLY_FLG CHAR(1) NOT NULL,
IVC_ALL_COMMENTS CHAR(1) NOT NULL,
SPAWNED_SHPMT_FLG CHAR(1) NOT NULL,
ORIG_SHPMT_SEQ CHAR(4) NOT NULL,
HAS_SPAWNED_FLG CHAR(1) NOT NULL,
SHIP_DATE_9CMP CHAR(8) NOT NULL,
BILL_PHONE_CNTRY CHAR(3) NOT NULL,
BILL_PHONE_AREA CHAR(3) NOT NULL,
BILL_PHONE_MAIN CHAR(7) NOT NULL,
FILL_BP CHAR(7) NOT NULL,
ORIG_PCK_NO CHAR(7) NOT NULL,
PREPAY_APPLY_FLG CHAR(1) NOT NULL,
IVC_BATCH_COMB_SHPMT CHAR(1) NOT NULL,
IVC_ASSIGN_FLAG CHAR(1) NOT NULL,
SAR_SOURCE_FLG CHAR(1) NOT NULL,
BLANKET_NO CHAR(7) NOT NULL,
FACILITY CHAR(3) NOT NULL,
SRVC_TYPE SMALLINT NOT NULL,
SHIPMENT_ID INTEGER NOT NULL,
SALESMAN CHAR(3) NOT NULL,
CONTRACT_FLG CHAR(1) NOT NULL,
PRICE_CATG_FLG CHAR(1) NOT NULL,
REPAIR_FRT_COST NUMERIC(11,2) NOT NULL,
SIX_DEC_TAX_FLG CHAR(1) NOT NULL,
TAX_ADJMT_FLG CHAR(1) NOT NULL,
EINVOICE_FLG CHAR(1) NOT NULL,
FILLER CHAR(738) NOT NULL 
);

CREATE UNIQUE NOT MODIFIABLE INDEX ORDER_HIST_HEADK00 IN DICTIONARY ON ORDER_HIST_HEAD
(INVOICE ASC,
ORDER_NO ASC,
ORDER_SUFFIX ASC
);

CREATE VIEW V_ORDER_HIST_HEAD AS SELECT 
INVOICE ,
ORDER_NO ,
ORDER_SUFFIX ,
ORDER_TYPE ,
CUSTOMER ,
BUY_GROUP_CUST ,
FLAG_BUY_GROUP ,
IF(SUBSTRING(DATE_ORDER,1,4) >= '1900' AND SUBSTRING(DATE_ORDER,1,4) <= '2999' AND SUBSTRING(DATE_ORDER,5,2) <= '12' AND SUBSTRING(DATE_ORDER,5,2) >= '01' AND SUBSTRING(DATE_ORDER,7,2) <= '31' AND SUBSTRING(DATE_ORDER,7,2) >= '01',CONVERT(SUBSTRING(DATE_ORDER,1,4) + '-' + SUBSTRING(DATE_ORDER,5,2) + '-' + SUBSTRING(DATE_ORDER,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_ORDER,
IF(SUBSTRING(DATE_ORDER_DUE,1,4) >= '1900' AND SUBSTRING(DATE_ORDER_DUE,1,4) <= '2999' AND SUBSTRING(DATE_ORDER_DUE,5,2) <= '12' AND SUBSTRING(DATE_ORDER_DUE,5,2) >= '01' AND SUBSTRING(DATE_ORDER_DUE,7,2) <= '31' AND SUBSTRING(DATE_ORDER_DUE,7,2) >= '01',CONVERT(SUBSTRING(DATE_ORDER_DUE,1,4) + '-' + SUBSTRING(DATE_ORDER_DUE,5,2) + '-' + SUBSTRING(DATE_ORDER_DUE,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_ORDER_DUE,
IF(SUBSTRING(DATE_PO_EXPIRE,1,4) >= '1900' AND SUBSTRING(DATE_PO_EXPIRE,1,4) <= '2999' AND SUBSTRING(DATE_PO_EXPIRE,5,2) <= '12' AND SUBSTRING(DATE_PO_EXPIRE,5,2) >= '01' AND SUBSTRING(DATE_PO_EXPIRE,7,2) <= '31' AND SUBSTRING(DATE_PO_EXPIRE,7,2) >= '01',CONVERT(SUBSTRING(DATE_PO_EXPIRE,1,4) + '-' + SUBSTRING(DATE_PO_EXPIRE,5,2) + '-' + SUBSTRING(DATE_PO_EXPIRE,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_PO_EXPIRE,
CUSTOMER_PO ,
FILL_CUSTPO ,
CONTRACT ,
NAME_CUSTOMER ,
ADDRESS1 ,
ADDRESS2 ,
ADDRESS3 ,
ADDRESS4 ,
ADDRESS5 ,
CITY ,
STATE ,
ZIP ,
COUNTRY ,
FLAG_INTL ,
ATTENTION ,
CONTACT ,
CONTACT_PHONE ,
CONTACT_EMAIL ,
CODE_SORT ,
ORDER_SORT_2 ,
USER_1 ,
USER_2 ,
USER_3 ,
USER_4 ,
USER_5 ,
QUOTE ,
TERMS ,
FLAG_TIME_MATL ,
LOCATION ,
FLAG_ALWAYS_DISC ,
FLAG_SPCD ,
PRICE_SCHEDULE ,
COMPANY_CURRENCY ,
CATALOG_CURRENCY ,
ORDER_CURRENCY ,
IF(SUBSTRING(DATE_EXCHANGE_FO_TC,1,4) >= '1900' AND SUBSTRING(DATE_EXCHANGE_FO_TC,1,4) <= '2999' AND SUBSTRING(DATE_EXCHANGE_FO_TC,5,2) <= '12' AND SUBSTRING(DATE_EXCHANGE_FO_TC,5,2) >= '01' AND SUBSTRING(DATE_EXCHANGE_FO_TC,7,2) <= '31' AND SUBSTRING(DATE_EXCHANGE_FO_TC,7,2) >= '01',CONVERT(SUBSTRING(DATE_EXCHANGE_FO_TC,1,4) + '-' + SUBSTRING(DATE_EXCHANGE_FO_TC,5,2) + '-' + SUBSTRING(DATE_EXCHANGE_FO_TC,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_EXCHANGE_FO_TC,
EXCHANGE_RATE_FO_TC ,
IF(SUBSTRING(DATE_EXCHANGE_FC_TO,1,4) >= '1900' AND SUBSTRING(DATE_EXCHANGE_FC_TO,1,4) <= '2999' AND SUBSTRING(DATE_EXCHANGE_FC_TO,5,2) <= '12' AND SUBSTRING(DATE_EXCHANGE_FC_TO,5,2) >= '01' AND SUBSTRING(DATE_EXCHANGE_FC_TO,7,2) <= '31' AND SUBSTRING(DATE_EXCHANGE_FC_TO,7,2) >= '01',CONVERT(SUBSTRING(DATE_EXCHANGE_FC_TO,1,4) + '-' + SUBSTRING(DATE_EXCHANGE_FC_TO,5,2) + '-' + SUBSTRING(DATE_EXCHANGE_FC_TO,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_EXCHANGE_FC_TO,
EXCHANGE_RATE_FC_TO ,
IF(SUBSTRING(DATE_EXCHANGE_FL_TO,1,4) >= '1900' AND SUBSTRING(DATE_EXCHANGE_FL_TO,1,4) <= '2999' AND SUBSTRING(DATE_EXCHANGE_FL_TO,5,2) <= '12' AND SUBSTRING(DATE_EXCHANGE_FL_TO,5,2) >= '01' AND SUBSTRING(DATE_EXCHANGE_FL_TO,7,2) <= '31' AND SUBSTRING(DATE_EXCHANGE_FL_TO,7,2) >= '01',CONVERT(SUBSTRING(DATE_EXCHANGE_FL_TO,1,4) + '-' + SUBSTRING(DATE_EXCHANGE_FL_TO,5,2) + '-' + SUBSTRING(DATE_EXCHANGE_FL_TO,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_EXCHANGE_FL_TO,
EXCHANGE_RATE_FL_TO ,
IF(SUBSTRING(DATE_EXCHANGE_FL_TC,1,4) >= '1900' AND SUBSTRING(DATE_EXCHANGE_FL_TC,1,4) <= '2999' AND SUBSTRING(DATE_EXCHANGE_FL_TC,5,2) <= '12' AND SUBSTRING(DATE_EXCHANGE_FL_TC,5,2) >= '01' AND SUBSTRING(DATE_EXCHANGE_FL_TC,7,2) <= '31' AND SUBSTRING(DATE_EXCHANGE_FL_TC,7,2) >= '01',CONVERT(SUBSTRING(DATE_EXCHANGE_FL_TC,1,4) + '-' + SUBSTRING(DATE_EXCHANGE_FL_TC,5,2) + '-' + SUBSTRING(DATE_EXCHANGE_FL_TC,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_EXCHANGE_FL_TC,
EXCHANGE_RATE_FL_TC ,
IF(SUBSTRING(DATE_SHIPPED,1,4) >= '1900' AND SUBSTRING(DATE_SHIPPED,1,4) <= '2999' AND SUBSTRING(DATE_SHIPPED,5,2) <= '12' AND SUBSTRING(DATE_SHIPPED,5,2) >= '01' AND SUBSTRING(DATE_SHIPPED,7,2) <= '31' AND SUBSTRING(DATE_SHIPPED,7,2) >= '01',CONVERT(SUBSTRING(DATE_SHIPPED,1,4) + '-' + SUBSTRING(DATE_SHIPPED,5,2) + '-' + SUBSTRING(DATE_SHIPPED,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_SHIPPED,
CUSTOMER_SHIP ,
NAME_CUSTOMER_SHIP ,
ADDRESS1_SHIP ,
ADDRESS2_SHIP ,
ADDRESS3_SHIP ,
ADDRESS4_SHIP ,
ADDRESS5_SHIP ,
CITY_SHIP ,
STATE_SHIP ,
ZIP_SHIP ,
COUNTRY_SHIP ,
FLAG_INTL_SHIP ,
ATTENTION_SHIP ,
FLAG_INS ,
FLAG_CERT_ENCL ,
MARK_INFO ,
FOB_INFO ,
WAYBILL ,
BATCH ,
IF(SUBSTRING(DATE_INVOICE,1,4) >= '1900' AND SUBSTRING(DATE_INVOICE,1,4) <= '2999' AND SUBSTRING(DATE_INVOICE,5,2) <= '12' AND SUBSTRING(DATE_INVOICE,5,2) >= '01' AND SUBSTRING(DATE_INVOICE,7,2) <= '31' AND SUBSTRING(DATE_INVOICE,7,2) >= '01',CONVERT(SUBSTRING(DATE_INVOICE,1,4) + '-' + SUBSTRING(DATE_INVOICE,5,2) + '-' + SUBSTRING(DATE_INVOICE,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_INVOICE,
COMPLEMENT_DATE_INV,
FLAG_EXCL_BOM_COMP ,
FLAG_1_INV_ORDER ,
FLAG_1_INV_CUST ,
FLAG_1_INV_SORT ,
FLAG_1_INV_ITEM ,
FLAG_1_INV_PART ,
COST_MATERIAL ,
COST_LABOR ,
COST_OUTSIDE ,
COST_OVERHEAD ,
COST_OTHER ,
JOB ,
SUFFIX ,
PRODUCT_CODE ,
JOB_DESCRIPTION ,
FLAG_JOB_CLOSE ,
PART_JOB ,
LOCATION_JOB ,
QTY_JOB ,
FLAG_PRICE_AT_COST ,
CREDIT_MEMO_FLAG ,
INVOICE_ORIGINAL ,
IF(SUBSTRING(DATE_ORIG_INVOICE,1,4) >= '1900' AND SUBSTRING(DATE_ORIG_INVOICE,1,4) <= '2999' AND SUBSTRING(DATE_ORIG_INVOICE,5,2) <= '12' AND SUBSTRING(DATE_ORIG_INVOICE,5,2) >= '01' AND SUBSTRING(DATE_ORIG_INVOICE,7,2) <= '31' AND SUBSTRING(DATE_ORIG_INVOICE,7,2) >= '01',CONVERT(SUBSTRING(DATE_ORIG_INVOICE,1,4) + '-' + SUBSTRING(DATE_ORIG_INVOICE,5,2) + '-' + SUBSTRING(DATE_ORIG_INVOICE,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS DATE_ORIG_INVOICE,
FLAG_TAX_ADJ ,
ORDER_SOURCE ,
HISTORY_SOURCE ,
HISTORY_VERSION ,
FREIGHT_ZONE ,
FLAG_COMPL_SHIP ,
PAYMENT_TYPE ,
PLST_FLAG ,
CREDIT_MEMO_TYPE ,
DD250_FLAG ,
LUMP_SUM_FLAG ,
LUMP_SUM_AMT ,
LANG_CD ,
CARRIER_CD ,
THRD_PRTY_FRT_CUST ,
PCK_NO ,
TRACKING_NO ,
TRACKING_FLAG ,
IF(SUBSTRING(ETA_DATE,1,4) >= '1900' AND SUBSTRING(ETA_DATE,1,4) <= '2999' AND SUBSTRING(ETA_DATE,5,2) <= '12' AND SUBSTRING(ETA_DATE,5,2) >= '01' AND SUBSTRING(ETA_DATE,7,2) <= '31' AND SUBSTRING(ETA_DATE,7,2) >= '01',CONVERT(SUBSTRING(ETA_DATE,1,4) + '-' + SUBSTRING(ETA_DATE,5,2) + '-' + SUBSTRING(ETA_DATE,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS ETA_DATE ,
TRANS_METHOD ,
IF(SUBSTRING(TERMS_DISC_DUE_DATE,1,4) >= '1900' AND SUBSTRING(TERMS_DISC_DUE_DATE,1,4) <= '2999' AND SUBSTRING(TERMS_DISC_DUE_DATE,5,2) <= '12' AND SUBSTRING(TERMS_DISC_DUE_DATE,5,2) >= '01' AND SUBSTRING(TERMS_DISC_DUE_DATE,7,2) <= '31' AND SUBSTRING(TERMS_DISC_DUE_DATE,7,2) >= '01',CONVERT(SUBSTRING(TERMS_DISC_DUE_DATE,1,4) + '-' + SUBSTRING(TERMS_DISC_DUE_DATE,5,2) + '-' + SUBSTRING(TERMS_DISC_DUE_DATE,7,2),SQL_DATE),CONVERT('1900-01-01',SQL_DATE)) AS TERMS_DISC_DUE_DATE,
TERMS_DISC_AMT ,
TERMS_DISC_AMT_ORDER ,
PROJECT ,
CARRIER_ACCT  ,
IVC_UPD_SCRIPT_FLG ,
CARTONS ,
WEIGHT ,
TAX_APPLY_1 ,
TAX_APPLY_2 ,
TAX_APPLY_3 ,
TAX_APPLY_4 ,
TAX_APPLY_5 ,
TAX_APPLY_6 ,
TAX_APPLY_7 ,
TAX_APPLY_8 ,
TAX_APPLY_9 ,
TAX_APPLY_10 ,
PRO_NO  ,
PRGBILL_ONLY_FLG ,
IVC_ALL_COMMENTS ,
SPAWNED_SHPMT_FLG ,
ORIG_SHPMT_SEQ ,
HAS_SPAWNED_FLG ,
SHIP_DATE_9CMP  ,
BILL_PHONE_CNTRY ,
BILL_PHONE_AREA ,
BILL_PHONE_MAIN ,
ORIG_PCK_NO ,
PREPAY_APPLY_FLG ,
IVC_BATCH_COMB_SHPMT ,
IVC_ASSIGN_FLAG ,
SAR_SOURCE_FLG ,
BLANKET_NO ,
FACILITY ,
SRVC_TYPE ,
SHIPMENT_ID ,
SALESMAN ,
CONTRACT_FLG ,
PRICE_CATG_FLG ,
REPAIR_FRT_COST ,
SIX_DEC_TAX_FLG ,
TAX_ADJMT_FLG ,
EINVOICE_FLG
FROM ORDER_HIST_HEAD
;